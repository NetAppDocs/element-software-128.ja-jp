---
permalink: concepts/concept_data_manage_volumes_solidfire_quality_of_service.html 
sidebar: sidebar 
keywords: solidfire, element, qos, performance, iops 
summary: 'SolidFireストレージ クラスターには、ボリュームごとにサービス品質 (QoS) パラメータを提供する機能があります。  QoS を定義する 3 つの構成可能なパラメータ (最小 IOPS、最大 IOPS、バースト IOPS) を使用して、1 秒あたりの入出力数 (IOPS) で測定されるクラスター パフォーマンスを保証できます。' 
---
= パフォーマンスとサービス品質
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SolidFireストレージ クラスターには、ボリュームごとに QoS (Quality of Service) パラメータを提供する機能があります。  QoS を定義する 3 つの構成可能なパラメータ (最小 IOPS、最大 IOPS、バースト IOPS) を使用して、1 秒あたりの入出力数 (IOPS) で測定されるクラスターのパフォーマンスを保証できます。


NOTE: SolidFire Active IQには、最適な構成と QoS 設定のセットアップに関するアドバイスを提供する QoS 推奨ページがあります。



== サービス品質パラメータ

IOPS パラメータは次のように定義されます。

* *最小 IOPS* - ストレージ クラスターがボリュームに提供する 1 秒あたりの持続的な入出力 (IOPS) の最小数。ボリュームに設定された最小 IOPS は、ボリュームの保証されたパフォーマンス レベルです。パフォーマンスはこのレベル以下に低下しません。
* *最大 IOPS* - ストレージ クラスターがボリュームに提供する持続的な IOPS の最大数。クラスターの IOPS レベルが非常に高い場合、この IOPS パフォーマンス レベルを超えることはありません。
* *バースト IOPS* - 短いバースト シナリオで許可される IOPS の最大数。ボリュームが最大 IOPS を下回って実行されている場合、バースト クレジットが蓄積されます。パフォーマンス レベルが非常に高くなり、最大レベルに達すると、ボリューム上で IOPS の短時間のバーストが許可されます。
+
Element ソフトウェアは、クラスターの IOPS 使用率が低い状態でクラスターが実行されているときにバースト IOPS を使用します。

+
1 つのボリュームでバースト IOPS を蓄積し、クレジットを使用して、設定された「バースト期間」の間、最大 IOPS を超えてバースト IOPS レベルまでバーストすることができます。クラスターにバーストに対応できる容量がある場合、ボリュームは最大 60 秒間バーストできます。ボリュームは、最大 IOPS 制限を下回る 1 秒ごとに 1 秒のバースト クレジット (最大 60 秒) を蓄積します。

+
バースト IOPS は次の 2 つの方法で制限されます。

+
** ボリュームは、蓄積されたバースト クレジットの数に等しい秒数、最大 IOPS を超えてバーストすることができます。
** ボリュームが最大 IOPS 設定を超えてバーストすると、バースト IOPS 設定によって制限されます。したがって、バースト IOPS はボリュームのバースト IOPS 設定を超えることはありません。


* *実効最大帯域幅* - 最大帯域幅は、IOPS 数 (QoS 曲線に基づく) と IO サイズを掛けて計算されます。
+
例: QoS パラメータ設定を 100 最小 IOPS、1000 最大 IOPS、1500 バースト IOPS にすると、パフォーマンスの品質に次のような影響があります。

+
** ワークロードは、クラスター上で IOPS のワークロード競合の状態が明らかになるまで、最大 1000 IOPS に到達して維持することができます。その後、すべてのボリュームの IOPS が指定された QoS 範囲内になり、パフォーマンスの競合が軽減されるまで、IOPS は段階的に削減されます。
** すべてのボリュームのパフォーマンスは、最小 IOPS 100 に近づきます。レベルは最小 IOPS 設定を下回ることはありませんが、ワークロードの競合が軽減されると 100 IOPS より高いままになる可能性があります。
** パフォーマンスは、持続的に 1000 IOPS を超えることはなく、100 IOPS を下回ることはありません。 1500 IOPS (バースト IOPS) のパフォーマンスは許可されますが、最大 IOPS 未満で実行してバースト クレジットを獲得したボリュームに対してのみ、短期間のみ許可されます。バーストレベルは決して持続されません。






== QoS値の制限

QoS に可能な最小値と最大値は次のとおりです。

[cols="7*"]
|===
| パラメータ | 最小値 | デフォルト | 4 4KB | 5 8KB | 6 16KB | 262 KB 


| 最小 IOPS | 50 | 50 | 15,000 | 9,375* | 5556* | 385* 


| 最大 IOPS | 100 | 15,000 | 200,000** | 125,000 | 74,074 | 5128 


| バースト IOPS | 100 | 15,000 | 200,000** | 125,000 | 74.074 | 5128 
|===
*これらの見積りは概算です。 **最大 IOPS とバースト IOPS は最大 200,000 まで設定できますが、この設定はボリュームのパフォーマンスを実質的に制限しない場合にのみ許可されます。ボリュームの実際の最大パフォーマンスは、クラスターの使用状況とノードごとのパフォーマンスによって制限されます。



== QoSパフォーマンス

QoS パフォーマンス曲線は、ブロック サイズと IOPS のパーセンテージの関係を示します。

ブロック サイズと帯域幅は、アプリケーションが取得できる IOPS の数に直接影響します。 Element ソフトウェアは、ブロック サイズを 4k に正規化することで、受信するブロック サイズを考慮します。ワークロードに基づいて、システムはブロック サイズを増やす可能性があります。ブロック サイズが大きくなるにつれて、システムはより大きなブロック サイズを処理するために必要なレベルまで帯域幅を増加させます。帯域幅が増加すると、システムが達成できる IOPS の数は減少します。

QoS パフォーマンス曲線は、ブロック サイズの増加と IOPS の割合の減少の関係を示します。

image::../media/solidfire_qos_performance_curve.png[QoS に関して、ブロック サイズの増加と IOPS の関係について説明します。]

たとえば、ブロック サイズが 4k、帯域幅が 4000 KBps の場合、IOPS は 1000 になります。ブロック サイズが 8k に増加すると、帯域幅は 5000 KBps に増加し、IOPS は 625 に減少します。ブロック サイズを考慮することにより、システムは、バックアップやハイパーバイザ アクティビティなど、高いブロック サイズを使用する優先度の低いワークロードが、より小さなブロック サイズを使用する優先度の高いトラフィックに必要なパフォーマンスを過度に消費しないようにします。



== QoSポリシー

QoS ポリシーを使用すると、多くのボリュームに適用できる標準化されたサービス品質設定を作成して保存できます。

QoS ポリシーは、再起動がほとんどなく、ストレージへの一定のアクセスが常に必要なデータベース、アプリケーション、インフラストラクチャ サーバーなどのサービス環境に最適です。個別ボリューム QoS は、仮想デスクトップや特殊なキオスク タイプの VM など、毎日または 1 日に数回再起動、電源オン、電源オフが行われる可能性のある軽量 VM に最適です。

QoS と QoS ポリシーを併用しないでください。 QoS ポリシーを使用している場合は、ボリューム上でカスタム QoS を使用しないでください。カスタム QoS は、ボリューム QoS 設定の QoS ポリシー値を上書きして調整します。


NOTE: QoS ポリシーを使用するには、選択したクラスターが Element 10.0 以降である必要があります。それ以外の場合、QoS ポリシー機能は使用できません。



== 詳細情報の参照

* https://docs.netapp.com/us-en/element-software/index.html["SolidFireおよびElementソフトウェアのドキュメント"]

